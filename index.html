<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Streamzu</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  background:#0f0f0f;
  color:#fff;
  font-family:system-ui,sans-serif;
  margin:0;
}
.container {
  max-width:1000px;
  margin:auto;
  padding:16px;
}
.player iframe {
  width:100%;
  height:420px;
  border-radius:12px;
  border:0;
}
.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:14px;
}
.card {
  cursor:pointer;
}
.card img {
  width:100%;
  border-radius:10px;
}
.card p {
  font-size:14px;
  margin:6px 0 0;
}
</style>
</head>

<body>

<div class="container">

  <h2>ðŸŽ¬ Now Playing</h2>
  <div class="player">
    <iframe id="player" allowfullscreen></iframe>
  </div>

  <h3>ðŸ“º Video Lainnya</h3>
  <div id="videos" class="grid"></div>

</div>

<script>
const API = "https://snowy-fog-a471.ap5089393.workers.dev/videos";
const player = document.getElementById("player");
const list = document.getElementById("videos");

function play(code) {
  player.src = "https://filemoon.to/e/" + code;
  location.hash = "/e/" + code;
}

fetch(API)
.then(res => res.json())
.then(data => {
  const files = data.result.files;
  if (!files.length) return;

  // autoplay pertama
  play(files[0].file_code);

  files.forEach(v => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${v.single_img}">
      <p>${v.title}</p>
    `;
    card.onclick = () => play(v.file_code);
    list.appendChild(card);
  });
});

// buka langsung dari URL hash
if (location.hash.startsWith("#/e/")) {
  const code = location.hash.split("/").pop();
  play(code);
}
</script>

</body>
</html>
